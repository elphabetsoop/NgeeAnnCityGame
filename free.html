<!--This code is testing for the load saved game function (please remove if necessary execpt for the save game function)-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Free Play Mode | NgeeAnnCityGame</title>
    <link rel="icon" href="assets/player.png">
    <link rel="stylesheet" href="css/styles.css" />
</head>
<body>

    <script src="scripts/load-save-game.js"></script>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const shouldLoad = urlParams.get('load');

        if (shouldLoad === 'true') {
            loadSavedGame();
        }

        // Save game with updated inputs
        function saveGame() {
            const score = parseInt(document.getElementById('scoreInput').value);
            const inventoryText = document.getElementById('inventoryInput').value;
            const inventory = inventoryText.split(',').map(item => item.trim()).filter(item => item);

            const gameState = {
                playerPosition: { x: 100, y: 200 }, // sample fixed position
                score: score,
                inventory: inventory
            };

            localStorage.setItem('myGameSave', JSON.stringify(gameState));
            alert('Game saved!');

            // Update displays
            document.getElementById('scoreDisplay').textContent = `Score: ${score}`;
            document.getElementById('inventoryDisplay').textContent = `Inventory: ${inventory.join(', ')}`;
        }
    </script>

    <!-- Tutorial Modal for Free Play -->
    <div id="tutorialModal" class="custom-modal">
    <div class="custom-modal-content">
        <h2 id="tutorialTitle">Welcome</h2>
        <p id="tutorialText">Welcome to Free Play mode!</p>
        <div class="modal-actions">
        <button id="tutorialBackBtn">‚¨Ö Back</button>
        <button id="tutorialNextBtn">Next ‚û°</button>
        </div>
    </div>
    </div>

    <!-- Button to trigger tutorial manually -->
    <button id="tutorialBtn" class="exit-button" style="top: 20px; right: 20px; left: auto;">
    Tutorial
    </button>
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('tutorial') === 'true' && typeof showTutorial === 'function') {
            showTutorial();
            }
        });
    </script>
    <script src="scripts/freeplay_tutorial.js"></script>

    <!-- Game Over Modal -->
     <div id="gameOverModal" class="custom-modal hidden">
          <div class="custom-modal-content">
               <h2>üèÅ Game Over</h2>
               <p>Your final score: <span id="finalScore">0</span></p>
               <p>Total turns taken: <span id="finalTurns">0</span></p>
               <div id="buildingStatsSummary" style="margin: 15px 0; text-align: left;"></div>
               <div class="modal-actions">
                    <button onclick="window.location.href='arcade.html'">üîÑ Play Again</button>
                    <button onclick="window.location.href='index.html'" class="btn-custom">üè† Main Menu</button>
               </div>
          </div>
     </div>

     <!-- Demolish Reminder Modal -->
     <div id="demolishModal" class="custom-modal">
          <div class="custom-modal-content">
               <p>üöß <strong>Demolish Mode is ON</strong></p>
               <p>Each demolished building will cost <strong>1 coin</strong>.</p>
               <button id="closeDemolishModal">OK</button>
          </div>
     </div>

     <!-- Exit Confirmation Modal -->
     <div id="exitModal" class="custom-modal">
          <div class="custom-modal-content">
               <p>‚ö†Ô∏è <strong>Are you sure you want to exit to the main menu?</strong></p>
               <p>Your progress will be lost unless saved.</p>
               <div class="modal-actions">
                    <button id="cancelExit">Cancel</button>
                    <button id="confirmExit">Exit</button>
               </div>
          </div>
     </div>

     <!-- Main Game Interface -->
     <button id="exitBtn" class="exit-button">Exit to Main Menu</button>
     <div class="main-wrapper">
          <h1>Ngee Ann City - Freeplay Mode</h1>
          <div class="coin-info">
                <p>Coins: <span id="coinCount">Unlimited</span></p>
                <p>Current Upkeep: <span id="currentUpkeep">0</span></p>
                <p>Current Profit: <span id="currentProfit">0</span></p>
          </div>
          
          <div class="game-info">
                <p>Turn: <span id="turnCount">1</span></p>
                <p>Score: <span id="scoreDisplay">0</span></p>
                <button id="saveGameBtn" class="save-button">Save Game</button>
                <button id="demolishBtn" class="demolish-button">Demolish Mode: OFF</button>
          </div>
          <div class="canvas-container">
               <canvas id="gameCanvas" width="960" height="960"></canvas>
          </div>
          <h2>Choose a Building</h2>
          <div id="buildingChoices" class="choices"></div>
     </div>

     <script type="module" src="scripts/freeplay.js"></script>


</body>
</html>
